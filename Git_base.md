### 忽略文件

文件`.gitignore`的格式规范如下：

- 所有空行或以#开头的行都会被Git忽略。
- 可以使用标准的glob模式匹配，它会递归地应用在整个工作区中。
- 匹配模式可以以`/`开头防止递归。
- 匹配模式可以以`/`结尾指定目录。
- 要忽略指定模式以外的文件或目录，可以在指定模式前加上叹号`（!）`取反。

### 查看已暂存和未暂存的修改

要查看尚未暂存的文件更新了哪些部分，不加参数直接运行`git diff`。

若要查看已暂存的将要添加到下次提交的修改，可以用`git diff --staged`命令`--staged`和`--cached`是同义词。这条命令将对比已暂存文件与最后一次提交的文件差异。

### 移除文件

要从Git中移除某个文件，就必须要从已跟踪文件清单中移除（确切地说，是从暂存区移除），然后提交。可以用`git rm`命令完成此项工作，并连带从工作目录中删除指定的文件。如果要删除已经修改过或已经放入暂存区的文件，则必须使用强制删除选项`-f`。这是一种安全特性，用于防止误删尚未添加到快照的数据，这样的数据不能被GIt恢复。另一种情况是，我们想把文件从Git仓库中删除（亦即从暂存区移除），但仍希望保存在当前工作目录中，可以使用`--cached`选项。

## git log

-p（--patch）选项会显示每次提交所引入的差异（按补丁的格式给出）。

### 限制输出长度

类似--since和--until这种按照时间做限制的的选项很有用。下面的命令会列出最近两周所有的提交：

```bash
git log --since=2.weeks
```

该命令可用的格式十分丰富--可以是类似"2018-05-13"的具体的某一天，也可以是"two year 1 day 3 minutes ago"的相对日期。

还可以过滤出匹配指定条件的提交。用--author选项显示指定作者的提交，用--grep搜索提交说明中的关键字。

```bash
git log --author=dengj60 --oneline --since=2025.01.01 --grep="ikev2"
```

另一个非常有用的过滤器是-S（俗称“pickaxe”选项，取“用鹤嘴锄在土里捡石头之意”），它接受一个字符串参数，并且只会显示那些添加或删除了该字符串的提交。假设你想找出添加或删除了对某个特定函数的引用的提交，可以调用：

```bash
git log -S ikev2_set_log_level_command_fn
```

最后一个很实用的选项是路径（path），如果只关心某些文件或目录的提交历史，可以在git log选项的最后指定它们。

```
git log --oneline -- path
```

| 选项             | 说明                                     |
| ---------------- | ---------------------------------------- |
| -<n>             | 仅显示最近的n条提交历史                  |
| --since;--after  | 仅显示指定时间之后的提交                 |
| --until;--before | 仅显示指定时间之前的提交                 |
| --author         | 仅显示作者匹配指定字符串的提交           |
| --committer      | 仅显示提交者匹配指定字符串的提交         |
| --grep           | 仅显示提交说明中包含指定字符串的提交     |
| -S               | 仅显示添加或删除内容匹配指定字符串的提交 |

## 撤销操作

有时候提交完了发现漏掉了几个文件没有添加，或已提交的文件包好笔误，或者提交信息写错了，此时可以用带有--amend选项的提交命令来重新提交：

```bash
git commit --amend
```

记住，在Git中任何**已提交**的东西几乎都是可以恢复的。甚至那些被删除的分支中的提交或使用`--amend`选项覆盖的提交也可以恢复。然而，任何你未提交的东西丢失后很可能再也找不到了。

## 远程仓库的使用

如果你的当前分支设置了跟踪远程分支，那么可以使用`git pull`命令来自动抓取后合并该远程分支到当前分支。这或许是更加简单舒服的工作流程。默认情况下，`git clone`命令会自动设置本地`master`分支跟踪克隆的远程仓库的`master`分支（或其他名字的默认分支）。运行`git pull`通常会从最初克隆的仓库上抓取数据并自动尝试合并到当前分支。

如果想要查看某个远程仓库更多地信息，可以使用git remote show <remote>命令。这个命令列出了当你在特定的分支上执行git push会自动地推送到哪个远程分支。它也同样地列出了哪些远程分支不在你的本地，哪些远程分支已经从服务器上移除了，还有当你执行git pull时哪些本地分支可以与它跟踪的远程分支自动合并。

## 打标签

### 列出标签

如果你只想要完整的标签列表，运行git tag会直接给你按字母顺序列出来，此时的-l或--list是可选的。然而，如果你提供了一个匹配标签名的通配模式，那么-l或--list就是强制使用的。

打附注标签：

```
git tag -a v1.1 -m "标签信息"
```

打轻量标签：

```
git tag v1.1
```

针对某个提交打标签：

```
git tag -a v1.1 0a18def
```

### 删除标签

删除本地标签：`git tag -d <tagname>`。

删除远程标签：

1. `git push <remote> :refs/tags/<tagname>`

   这种操作的含义是将冒号前面的空值推送到远程仓库，从而高效的删除它。

2. `git push <remote> --delete <tagname>`
